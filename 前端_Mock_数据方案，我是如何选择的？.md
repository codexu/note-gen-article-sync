# å‰ç«¯ Mock æ•°æ®æ–¹æ¡ˆï¼Œæˆ‘æ˜¯å¦‚ä½•é€‰æ‹©çš„ï¼Ÿ

## å‰è¨€

`Mock`Â å¯ä»¥ç¿»è¯‘ä¸ºâ€œæ¨¡æ‹Ÿâ€ï¼Œåœ¨å‰ç«¯å¼€å‘ä¸­é€šå¸¸æŒ‡æ¨¡æ‹Ÿåç«¯æ¥å£å’Œæ•°æ®ã€‚

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c7c4275bcd184767a41a8349992f248e~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=733&h=296&s=86366&e=png&b=fefefe)

ç›®å‰é’ˆå¯¹ mock çš„æ–¹å¼å¯ä»¥è¯´æ˜¯äº”èŠ±å…«é—¨ï¼Œæœ¬æ–‡é€šè¿‡å¯¹æ¯”åˆ†æä¸»æµæ–¹æ¡ˆï¼Œå¸®åŠ©å¤§å®¶é€‰æ‹©é€‚åˆè‡ªå·±æ–¹æ¡ˆã€‚

## ä¸ºä»€ä¹ˆç”¨?

> **çœæµï¼šæˆ‘è”è°ƒæ—¶é—´ç´§å¼ ï¼Œä¸æƒ³åŠ ç­ã€‚**

æˆ‘ä»¬åœ¨å¼€å‘çš„æ—¶å€™ï¼Œä¸€èˆ¬éƒ½æ˜¯å‰åç«¯åŒæ—¶å¼€å‘ï¼Œå°¤å…¶æ˜¯æŸäº›åå°ç³»ç»Ÿå¼€å‘æ—¶ï¼Œå¾ˆå¤šå‰ç«¯åŒå­¦åˆ†åˆ†é’Ÿå°±å¯ä»¥åšå®Œé™æ€é¡µé¢çš„å¼€å‘ï¼Œç„¶åå°±æ˜¯æ‘¸é±¼æ—¶é—´ï¼Œç­‰å¾…åç«¯çš„æ¥å£ã€‚å¦‚æœä½ çš„**åç«¯åŒäº‹éå¸¸é…åˆ**ï¼Œæ„¿æ„åœ¨è®¾è®¡æ•°æ®åº“çš„æ—¶å€™é¡ºä¾¿å®šå¥½è¿”å›çš„æ•°æ®ç»“æ„å’Œå­—æ®µï¼Œå¹¶ä¸”**è”è°ƒæ—¶é—´å¾ˆç´§å¼ **çš„æ—¶å€™ï¼Œè¿™æ—¶å€™ä½ åº”è¯¥è€ƒè™‘ç€æ‰‹å»åšä¸€ä¸‹å‰ç«¯ mockï¼Œä¸ºè”è°ƒäº‰å–æ—¶é—´ã€‚

## ä¸ºä»€ä¹ˆä¸ç”¨?

> **çœæµï¼šæˆ‘è”è°ƒæ—¶é—´å……è¶³ï¼Œä¸å¦‚æ‘¸é±¼ã€‚**

ä¸è®ºä»€ä¹ˆæŠ€æœ¯ï¼Œéƒ½å­˜åœ¨**åå¯¹**çš„å£°éŸ³ï¼š

- `ä¸åˆ‡å®é™…`ï¼šMock çš„æ•°æ®å¹¶ä¸æ˜¯çœŸå®çš„åç«¯æ•°æ®ï¼Œåç«¯æœ‰æ—¶éƒ½ç¡®å®šä¸äº†æ•°æ®ç»“æ„ï¼Œå¯èƒ½ä¼šå¯¼è‡´å‰ç«¯å¼€å‘äººå‘˜åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¯¹æ¥å£çš„ç†è§£å‡ºç°åå·®ï¼Œæœ€ç»ˆå¯¼è‡´ä¸åç«¯æ¥å£ä¸å…¼å®¹çš„æƒ…å†µã€‚
- `æµªè´¹æ—¶é—´`ï¼šç¼–å†™æ¨¡æ‹Ÿæ•°æ®å¯èƒ½ä¼šæµªè´¹ä¸€äº›æ—¶é—´ï¼Œç‰¹åˆ«æ˜¯åœ¨æ¥å£æ¯”è¾ƒå¤æ‚çš„æƒ…å†µä¸‹ã€‚

å­˜åœ¨åå¯¹çš„å£°éŸ³æ˜¯å¾ˆæ­£å¸¸çš„ï¼Œå¯èƒ½æ˜¯è¿˜æ²¡æœ‰çœŸæ­£é‡åˆ°éœ€è¦ mock çš„åœºæ™¯ï¼Œæˆ–è€…æ˜¯å› ä¸ºäº†è§£åˆ°çš„ mock æ–¹æ¡ˆå¹¶ä¸é€‚ç”¨ã€‚

å†™è¿™ç¯‡æ–‡ç« ï¼ŒæŸ¥çœ‹äº†è®¸å¤šçœ‹äº†æ–‡ç« ï¼Œåœ¨è¯„è®ºåŒºæ€»ç»“äº†å¾ˆå¤šäººå¯¹ mock è¿™ä»¶äº‹å­˜åœ¨çš„`è¯¯åŒº`ï¼š

**1. åç«¯æ¥å£æ¯ä¸€ä¸ªæˆ‘éƒ½éœ€è¦ mockã€‚**

å…¶å®çœŸçš„æ²¡å¿…è¦ï¼Œä½¿ç”¨ mock æ—¶ï¼Œå¯ä»¥å»æ¨¡æ‹Ÿä¸€äº›å®¹æ˜“åœ¨è”è°ƒæ—¶å‡ºé—®é¢˜çš„æ¥å£ã€‚è¿™å°±ç±»ä¼¼çƒ§æ°´çš„é—®é¢˜ï¼Œä½ åœ¨ç­‰å¾…æ°´çƒ§å¼€çš„æ—¶å€™ï¼Œå¯ä»¥å»æ‹‰å±ï¼Œä½†æ²¡å¿…è¦åŒæ—¶å»åƒå£é¥­ã€‚

**2. åç«¯æ¥å£ã€å­—æ®µæˆ–ç»“æ„ä¿®æ”¹æ—¶ï¼Œmock æ¥å£ä¹Ÿè¦åŒæ­¥ä¿®æ”¹ã€‚**

è¿™ä¸ªæ—¶å€™æ¥å£å·²ç»å‡ºäº†ï¼Œä½ è¦åšçš„æ˜¯ä¿®æ”¹ä½ çš„ä¸šåŠ¡ä»£ç ï¼Œè€Œä¸æ˜¯ mock æ¥å£ã€‚è¿™ä¸ªæ—¶å€™ mock å·²ä¸å†é‡è¦ï¼Œä½ åˆ é™¤å®ƒåè€Œæ›´å¥½ï¼Œè°ƒç”¨çœŸå®çš„æ¥å£å»æµ‹è¯•ä¸æ˜¯æ›´å¥½å—ï¼Ÿ

**3. åç«¯éƒ½ç¡®å®šä¸äº†æ•°æ®ç»“æ„ï¼Œæ€ä¹ˆ mock éƒ½æ˜¯æ— ç”¨çš„ã€‚**

è¿åç«¯éƒ½æ— æ³•ç¡®å®šæ—¶ï¼Œé‚£å‰ç«¯ç¡®å®æ²¡å¿…è¦ mockï¼Œç­‰ç€å°±å¯ä»¥äº†ã€‚ä½†å¤§å¤šæ•°çš„æ—¶å€™ï¼Œæ¥å£çš„ç»“æ„éƒ½æ˜¯ç±»ä¼¼çš„ï¼Œç”¨ä½ å¤šå¹´çš„å¼€å‘ç»éªŒå’Œå›¢é˜Ÿé…åˆï¼Œå³ä½¿åç«¯ä»€ä¹ˆä¹Ÿæ²¡è¯´ï¼Œä½ ä¹Ÿåº”è¯¥å¯ä»¥çŒœä¸ªå¤§æ¦‚ï¼Œå¯¹äºè¿™æ ·çš„æ¥å£æˆ‘ä»¬ç¡®å®å¯ä»¥ mockï¼Œè€ŒçœŸå®çš„æ¥å£æ‹¿åˆ°æ—¶ï¼ŒåŸºæœ¬ä¸Šä¹Ÿå°±æ˜¯æ”¹æ”¹å­—æ®µåç§°ã€‚æˆ–è®¸å¯ä»¥å†å¤§èƒ†ä¸€ç‚¹ï¼Œä½ ç”¨è‡ªå·±å®šä¹‰å¥½çš„ç»“æ„ï¼Œåˆ†äº«ç»™åç«¯ï¼Œæ²¡å‡†ä¹Ÿå¯ä»¥è®©åç«¯æŒ‰ç…§ä½ çš„å¸Œæœ›ç»“æ„è¿”å›ç»™ä½ ã€‚

> å½“æ”¶ç›Šå¤§äºæˆæœ¬æ—¶ï¼Œä½ æ‰åº”è¯¥è€ƒè™‘å»åšã€‚

å¦‚æœä½ ç°åœ¨è§‰å¾— mock ä¹Ÿæ˜¯å¯ä»¥åšçš„ï¼Œé‚£ä¹ˆä¸å¦¨çœ‹ä¸€ä¸‹ä¸‹æ–‡ï¼Œæˆ‘å¯¹ä¸»æµ mock æ–¹æ¡ˆçš„å¯¹æ¯”ã€‚

## ä¸»æµ Mock æ–¹æ¡ˆå¯¹æ¯”

> **çœæµï¼šæ¨èä½¿ç”¨å¹³å°ç±»æˆ–è¯·æ±‚æ‹¦æˆªçš„æ–¹æ¡ˆã€‚**

æœ¬ç« èŠ‚è®²è§£å…­ç±»**å¸¸è§çš„ mock æ–¹æ¡ˆ**ï¼š

- ä»£ç ä¾µå…¥
- æŠ“åŒ…å·¥å…· (Fiddlerã€Charles)
- æœ¬åœ°æœåŠ¡ (json-serverã€express)
- æµè§ˆå™¨æ’ä»¶ (Requestly)
- å¹³å° (Apifoxã€YApi)
- è¯·æ±‚æ‹¦æˆª (Mock.js)

é€šè¿‡ **5 ä¸ªç»´åº¦**å»åˆ†æä»–ä»¬çš„**ä¼˜ç‚¹å’Œç¼ºç‚¹**ï¼š

- `ç®€å•æ€§`ï¼šä¸éœ€è¦å¤æ‚çš„é…ç½®å’Œéƒ¨ç½²è¿‡ç¨‹ï¼Œå¯ä»¥å¿«é€Ÿåœ°åˆ›å»ºå’Œç®¡ç†æ¨¡æ‹Ÿæ•°æ®ã€‚
- `çµæ´»æ€§`ï¼šå¯ä»¥æ»¡è¶³ä¸åŒçš„å¼€å‘éœ€æ±‚ï¼Œä¾‹å¦‚æ”¯æŒä¸åŒçš„è¯·æ±‚ç±»å‹ã€ä¸åŒçš„è¯·æ±‚æ–¹å¼ç­‰ã€‚
- `çœŸå®æ€§`ï¼šèƒ½å¤Ÿç”Ÿæˆæ›´æ¥è¿‘çœŸå®çš„æ•°æ®ï¼Œå¯ä»¥æ¨¡æ‹Ÿä¸åŒçš„æ•°æ®ç±»å‹ã€æ ¼å¼å’Œç»“æ„ã€‚
- `ç»´æŠ¤æ€§`ï¼šå¯ä»¥æ–¹ä¾¿åœ°æ›´æ–°å’Œä¿®æ”¹æ¨¡æ‹Ÿæ•°æ®ã€‚
- `åˆä½œæ€§`: å¯ä»¥åœ¨å›¢é˜Ÿå†…æ–¹ä¾¿çš„å…±äº«æ¨¡æ‹Ÿæ•°æ®ã€‚

å¹¶ä¸”æŒ‰ç…§æˆ‘ä¸ªäººçš„ç†è§£å¯¹å…¶æ ‡è®°å‡º**æ¨èæŒ‡æ•°**ï¼Œ5 åˆ†åˆ¶ã€‚

### 1. ä»£ç ä¾µå…¥

**æ¨èæŒ‡æ•°**ï¼šâ­

ä»£ç ä¾µå…¥å¯ä»¥è¯´æ˜¯å¼€å‘ä¸­æœ€å¸¸è§çš„æ–¹å¼ï¼Œå¯ä»¥è¯´æ¯ä¸ªäººéƒ½è¿™ä¹ˆåšè¿‡ã€‚è¿™ç§æ–¹å¼è™½ç„¶ä¸å¥½ï¼Œä½†æ˜¯æä¸ºæ–¹ä¾¿ï¼Œé€‚åˆç®€å•çš„é€»è¾‘å¼€å‘ï¼Œå³ç”¨å³åˆ ï¼Œå¦åˆ™å‰æœŸä¸€æ—¶çˆ½ï¼ŒåæœŸç«è‘¬åœºã€‚

**å¸¸è§æ–¹æ¡ˆ**

- ç›´æ¥åœ¨ä»£ç ä¸­å†™æ­»
- å¯¼å…¥æœ¬åœ° json æ–‡ä»¶

**ä¼˜ç‚¹**

- æ–¹ä¾¿å¿«æ·ã€‚

**ç¼ºç‚¹**

- åˆ‡æ¢åˆ°çœŸå®æ¥å£æ—¶æ¯”è¾ƒéº»çƒ¦ï¼Œéœ€è¦åˆ é™¤æˆ–æ³¨é‡Š mock ä»£ç ï¼Œæ¥å£è¶Šå¤šè¶Šå®¹æ˜“å‡ºé”™ã€‚
- ä¸€åˆ‡éœ€è¦ä¾µå…¥ä¸šåŠ¡ä»£ç çš„éƒ½å¯ä»¥è¯´æ˜¯ä¸å¥½çš„ã€‚

### 2. æŠ“åŒ…å·¥å…·

**æ¨èæŒ‡æ•°**ï¼šâ­â­

ä½¿ç”¨æŠ“åŒ…å·¥å…·å¯ä»¥å¯¹ç½‘ç»œè¯·æ±‚è¿›è¡Œæ‹¦æˆªï¼Œå°†å…¶æ›¿æ¢ä¸ºæˆ‘ä»¬éœ€è¦çš„ Mock æ•°æ®ï¼Œè¿™ä¹Ÿä¸å¤±ä¸ºä¸€ç§ Mock æ–¹å¼ã€‚å…¶ä¼˜ç‚¹ä¸»è¦æ˜¯çœŸå®æ€§å¼ºï¼Œä½†è¿™ç§æ–¹å¼æ“ä½œæ­¥éª¤æ¯”è¾ƒç¹çï¼Œä¸æ–¹ä¾¿ç»Ÿä¸€é…ç½®ï¼ŒMock æˆæœ¬è¾ƒé«˜ã€‚

**å¸¸è§æ–¹æ¡ˆ**

- Fiddler
- Charles

ç§»åŠ¨ç«¯å¼€å‘å¯ä»¥äº†è§£ä¸€ä¸‹ï¼ŒWeb å¼€å‘æˆæœ¬å¤ªé«˜ï¼Œè¿™é‡Œä¸åšåˆ†æã€‚

### 3. æœ¬åœ°æœåŠ¡

**æ¨èæŒ‡æ•°**ï¼šâ­â­â­

æœ¬åœ°æœåŠ¡è¿™ç§æ–¹å¼æ¯”è¾ƒè‡ªç”±ï¼Œä½ å¯ä»¥ç”¨ä»»ä½•æŠ€æœ¯å®ç°ï¼Œç”šè‡³ä½ å¯ä»¥ç”¨ expressã€koaã€nest è¿™äº›æ–¹æ¡ˆï¼Œè‡ªå·±å†™ä¸€äº›æ¥å£ï¼Œä½†æ˜¯å¤šå°‘æ˜¯æœ‰ç‚¹æ¯›ç—…äº†ï¼Œä¸å¦‚ç›´æ¥å¹²å…¨æ ˆäº†ã€‚

å½“ç„¶ä¹Ÿæœ‰ä¸€äº›éå¸¸ä¸é”™çš„æ–¹æ¡ˆï¼Œå¯ä»¥ç®€å•çš„å®ç°æœ¬åœ°æœåŠ¡ + mock æ•°æ®ã€‚

**å¸¸è§æ–¹æ¡ˆ**

- [json-server](https://github.com/typicode/json-server)ï¼Œå¯ä»¥é€šè¿‡ä¸€ä¸ª **JSON** æ–‡ä»¶å¿«é€Ÿåˆ›å»ºä¸€ä¸ªæ¨¡æ‹Ÿçš„APIæœåŠ¡å™¨ã€‚
- è‡ªå»ºæœåŠ¡ç«¯ï¼Œå¯ä»¥é€šè¿‡ proxy åˆ‡æ¢æ¥å£ã€‚

### 4. æµè§ˆå™¨æ’ä»¶

**æ¨èæŒ‡æ•°**ï¼šâ­â­â­â­

æµè§ˆå™¨æ’ä»¶çš„æ–¹å¼ä¸å¹³å°ç±»ç›¸ä¼¼ï¼Œå®ƒè¿è¡Œäºä½ çš„æµè§ˆå™¨ï¼Œé¿å…äº†æœ¬åœ°éƒ¨ç½²æˆ–è€…ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„æœåŠ¡ã€‚ä½†å¦‚æœä½ æƒ³å›¢é˜Ÿåä½œï¼Œè¿˜æ˜¯ç»•ä¸å¼€ä¸‰æ–¹æœåŠ¡ã€‚

**å¸¸è§æ–¹æ¡ˆ**

- [Requestly: Open Source HTTPs Debugging Proxy](https://requestly.io/) ([Chrome åº”ç”¨å•†åº—](https://chrome.google.com/webstore/detail/requestly-open-source-htt/mdnleldcmiljblolnjhpnblkcekpdkpa?utm_source=ext_sidebar&hl=zh-CN))
- [Mock:Intercept and directly return data](https://chrome.google.com/webstore/detail/mockintercept-and-directl/kmphamhphplpcjcabjdjjklfjmgkmpba?utm_source=ext_sidebar&hl=zh-CN)

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/aef488bd878e49ecad71b1f77633ce74~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=640&h=400&s=167091&e=png&b=202020)

ï¼ˆä¸Šå›¾ä¸º Requestlyï¼‰

**ä¼˜ç‚¹**

- å®‰è£…ç®€å•ï¼Œåªéœ€è¦åœ¨æ’ä»¶å•†åŸå®‰è£…å³å¯ã€‚
- å­¦ä¹ æˆæœ¬æä½ï¼Œæ‹¥æœ‰å¯è§†åŒ–æ“ä½œç•Œé¢ï¼Œå‡ ä¹é›¶æˆæœ¬ä¸Šæ‰‹ã€‚
- ä½¿ç”¨ä¾¿æ·ï¼Œåœ¨æµè§ˆå™¨ä¸­è°ƒè¯•æ—¶éšæ—¶ä¿®æ”¹ã€‚

**ç¼ºç‚¹**

- ä¸é€‚åˆå›¢é˜Ÿåä½œï¼Œå‡ ä¹æ¶‰åŠå›¢é˜Ÿåä½œçš„æ—¶å€™éƒ½éœ€è¦ä»˜è´¹ä½¿ç”¨ã€‚
- æµè§ˆå™¨æ’ä»¶å¯èƒ½æ¯”è¾ƒåƒæ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯æ•°æ®é‡æ¯”è¾ƒå¤§çš„æ—¶å€™ã€‚
- å®‰å…¨ç¬¬ä¸€ï¼Œå°å¿ƒä½¿ç”¨ä¸è‰¯æ’ä»¶ã€‚

### 5. å¹³å°ç±»

**æ¨èæŒ‡æ•°**ï¼šâ­â­â­â­â­

å¤§å®¶å¤šå°‘éƒ½æœ‰æ¥è§¦è¿‡æ¥å£ç®¡ç†å·¥å…·ï¼Œå¸¸è§çš„æœ‰ Swaggerã€Postman ç­‰ã€‚æ¥å£ç®¡ç†å·¥å…· + Mock æ•°æ®ç»„åˆæˆä¸ºäº†å¹³å°ç±»çš„æ–¹æ¡ˆï¼Œè¿™ç±»æ–¹æ¡ˆä¸€èˆ¬æä¾›äº†äº‘ç«¯æœåŠ¡æˆ–è€…æœ¬åœ°åŒ–éƒ¨ç½²ï¼ˆå¯èƒ½æ”¶è´¹ï¼‰ã€‚

è€å¤–ä¹Ÿæ¯”è¾ƒæµè¡Œä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œçœ‹æ¥è¿™ç±»çœŸçš„æ˜¯**æœ‰åˆ©å¯å›¾**ã€‚

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d645739b92c042fabd7f62ec607ed6c1~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2600&h=1646&s=834952&e=png&a=1&b=1f2025)

ï¼ˆä¸Šå›¾ä¸º Apifoxï¼‰

å…¶å…·å¤‡å¯è§†åŒ–ç•Œé¢ä¹Ÿä½¿å¾— mock æ•°æ®ç®€å•äº†å¾ˆå¤šã€‚

**å¸¸è§æ–¹æ¡ˆ**

- [Apifox](https://apifox.com/)ï¼Œç›¸å½“äº Postman + Swagger + Mock + JMeter ç»„åˆã€‚
- [YApi](https://hellosean1025.github.io/yapi/)ï¼Œå…·å¤‡æƒé™ç®¡ç†ã€Mockã€æ•°æ®å¯¼å…¥ã€è‡ªåŠ¨åŒ–æµ‹è¯•ç­‰åŠŸèƒ½ã€‚
- [Moco](https://github.com/dreamhead/moco)ï¼Œè¿™æ˜¯ä¸ª java é¡¹ç›®ï¼Œå¯¹å‰ç«¯åŒå­¦ä¸å¤ªå‹å¥½ã€‚

**ä¼˜ç‚¹**

- é…ç½®å¼ºå¤§ï¼Œä¸€èˆ¬å¹³å°å·²ç»æä¾›äº†éå¸¸ä¸°å¯Œçš„å°è£…ï¼Œå‡ ä¹é€‚ç”¨äºä»»ä½•é¡¹ç›®å’Œåœºæ™¯ã€‚
- æ¥å£ç®¡ç†ä¸ Mock ä¸€ä½“ï¼Œä½¿ç”¨èµ·æ¥æ›´æ–¹ä¾¿ã€‚
- é€šå¸¸æä¾›äº†ä¸°å¯Œçš„æ•°æ®ç”Ÿæˆè§„åˆ™ï¼Œæ‹¿æ¥ç›´ç”¨ï¼Œç”Ÿæˆçš„æ•°æ®æ›´æ¥è¿‘çœŸå®ã€‚

**ç¼ºç‚¹**

- ä¾èµ–åç«¯ï¼Œä¸å…¶è®©åç«¯é…åˆ mockï¼Œä¸å¦‚è®©ä»–ä»¬åŠ é€Ÿæä¾›æ¥å£ã€‚
- ä¸å»ºè®®ä½¿ç”¨äº‘ç«¯æœåŠ¡ï¼Œæ¯•ç«Ÿå…¬å¸é¡¹ç›®å’Œè¿™äº›å¹³å°è°å…ˆå‡‰å‡‰è°ä¹Ÿæ‹¿ä¸å‡†ã€‚
- ç§æœ‰åŒ–éƒ¨ç½²ä¾èµ–å›¢é˜ŸåŸºå»ºï¼Œéœ€è¦è¿ç»´äººå‘˜é…åˆæ­å»ºã€‚

> æ›¾ç»æœ‰ä¸€ä¸ªå« [easy-mock](https://github.com/easy-mock/easy-mock) çš„åœ¨çº¿ mock æœåŠ¡å¹³å°ï¼Œæ—©å·²ä¸ç»´æŠ¤ï¼Œæˆ‘ä»¬è¦ä»ä¸­å¸å–æ•™è®­ã€‚

### 6. è¯·æ±‚æ‹¦æˆª

**æ¨èæŒ‡æ•°**ï¼šâ­â­â­â­â­

è¯·æ±‚æ‹¦æˆªæ˜¯é€šè¿‡æ‹¦æˆª XMLHttpRequest æˆ– fetch ç­‰ç½‘ç»œè¯·æ±‚ï¼Œç„¶åæ ¹æ®è‡ªå®šä¹‰è§„åˆ™è¿”å› mock æ•°æ®ã€‚åœ¨å›½å†…ï¼Œmock.js æ— ç–‘æ˜¯æœ€ä¼˜ç§€çš„è¯·æ±‚æ‹¦æˆªæ–¹æ¡ˆã€‚

**å¸¸è§æ–¹æ¡ˆ**

- [Mock.js](http://mockjs.com/)ï¼Œå‡ ä¹åœ¨å›½å†…æ˜¯ç»Ÿæ²»åœ°ä½ã€‚
- [axios-mock-adapter](https://github.com/ctimmerm/axios-mock-adapter)ï¼Œä¸ªäººä¸æ¨èã€‚

**ä¼˜ç‚¹**

- ä¸å†ä¾èµ–åç«¯ï¼Œå‰ç«¯è‡ªä¸»å®ç°ã€‚
- ä¸éœ€è¦ä¿®æ”¹ç°æœ‰çš„é€»è¾‘ä»£ç ï¼Œç›´æ¥æ‹¦æˆª Ajax è¯·æ±‚ï¼Œè¿”å›æ¨¡æ‹Ÿçš„å“åº”æ•°æ®ã€‚
- Mock.js è¿˜æä¾›äº†æ•°æ®æ¨¡æ¿å®šä¹‰åŠŸèƒ½ï¼Œå¯ä»¥è¿”å›æ›´åŠ çœŸå®çš„æ•°æ®ã€‚

**ç¼ºç‚¹**

- å¦‚æœéè¦æŒ‘ä¸€äº›ç¼ºç‚¹ï¼Œé‚£å°±æ˜¯éœ€è¦å®‰è£…é…ç½®ç¯å¢ƒï¼Œæœ‰ä¸€å®šçš„å­¦ä¹ æˆæœ¬ã€‚

## æˆ‘æ˜¯å¦‚ä½•é€‰æ‹©çš„ï¼Ÿ

> **çœæµï¼šä»¥ä¸Šçš„æ–¹æ¡ˆä¸€ä¸ªæ²¡æœ‰ä¸€ä¸ªé€‚åˆæˆ‘çš„ï¼Œæˆ‘é€‰æ‹©äº† MSW + Fakerã€‚**

ç»è¿‡ä¸Šæ–‡çš„åˆ†æï¼Œæœ€åæ¨èäº†`å¹³å°ç±»`å’Œ`è¯·æ±‚æ‹¦æˆª`çš„ä¸¤ç§æ–¹å¼ã€‚

æœ¬ç« èŠ‚å¼€å§‹ï¼Œè®²è¿°ä¸€ä¸‹æˆ‘çš„é€‰å‹æ–¹æ¡ˆã€åŸç†å’Œå®ç°æ–¹å¼ã€‚

### æŠ€æœ¯é€‰å‹

æ²¡æœ‰é€‰æ‹©å¹³å°ç±»çš„æ–¹æ¡ˆï¼ŒåŸå› é™¤äº†ä¸Šæ–‡æåˆ°çš„åŸå› ï¼Œæœ€ä¸»è¦è¿˜æ˜¯æƒ³ mock åœ¨å‰ç«¯å•ç‹¬å®ç°å³å¯ï¼Œä¸éº»çƒ¦å…¶ä»–åŒäº‹ã€‚

è¯·æ±‚æ‹¦æˆªçš„æ–¹å¼å®Œå…¨å¯ä»¥æ»¡è¶³æˆ‘çš„éœ€æ±‚ï¼Œä½†æ˜¯æˆ‘å¹¶æ²¡æœ‰é€‰æ‹©ä½¿ç”¨ mock.jsï¼Œä»¥ä¸‹æ˜¯å‡ ç‚¹åŸå› ï¼š

- åªæ”¯æŒ Ajaxï¼Œä¸æ”¯æŒ Fetchã€‚
- åªæ”¯æŒ Rest APIï¼Œä¸æ”¯æŒ GraphQL APIã€‚
- ä¸æ”¯æŒ tsï¼Œè¿™ç‚¹åœ¨ä¼ªé€ æ•°æ®æ—¶ï¼Œè¿˜éœ€è¦è®°ä½å„ç§è§„åˆ™ï¼Œæ²¡æœ‰ä»£ç æç¤ºã€‚
- å¯ä»¥æ‹¦æˆªè¯·æ±‚å¹¶è¿”å›æ¨¡æ‹Ÿæ•°æ®ï¼Œä½†æ˜¯æ— æ³•æ¨¡æ‹ŸçœŸå®çš„ç½‘ç»œè¯·æ±‚ï¼ˆåœ¨ DevTools ä¸­çœ‹ä¸åˆ°ï¼‰ã€‚
- å¤šå¹´ä¸ç»´æŠ¤ï¼Œè™½ç„¶åŠŸèƒ½å·²ç»å¾ˆå¼ºå¤§ï¼Œä½†è¿˜æ˜¯æ— æ³•æ»¡è¶³æˆ‘çš„éœ€æ±‚ã€‚

åæ¥å‘ç°äº†ä¸€ä¸ªæ›´åŠ å¼ºå¤§çš„åº“ï¼Œå«åš [Mock Service Worker](https://mswjs.io/)ï¼ˆä¸‹æ–‡ç®€å†™ä¸º MSWï¼‰ï¼Œå®ƒå¯ä»¥åœ¨æµè§ˆå™¨ä¸­æ¨¡æ‹ŸçœŸå®çš„ç½‘ç»œè¯·æ±‚å’Œå“åº”ï¼Œä»è€Œæ›´å¥½åœ°æµ‹è¯•å’Œè°ƒè¯•ã€‚

MSW åªè§£å†³äº†æ¨¡æ‹Ÿæ¥å£è¯·æ±‚ï¼Œä½†æ˜¯ä¸æ”¯æŒæ¨¡æ‹Ÿæ•°æ®ï¼Œæ•°æ®éœ€è¦ä½ è‡ªå·±é€ ï¼Œé‚£ä¹ˆæˆ‘æƒ³åˆ°äº†ä¸€ä¸ªåˆ¶é€ å‡æ•°æ®ï¼ˆä½†å¾ˆçœŸå®ï¼‰çš„åº“ï¼Œåå­—å« [Faker.js](https://fakerjs.dev/)ã€‚

æˆ‘æœ€åçš„æŠ€æœ¯é€‰å‹å°±æ˜¯ `MSW` + `Faker`ã€‚

### åŸç†

æ—¢ç„¶æ¯” mock.js å¼ºå¤§ï¼Œé‚£ä¹ˆå®ç°åŸç†è‚¯å®šä¹Ÿä¸åŒï¼Œ`MSW Browser` ä½¿ç”¨ [Service Worker API](https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API) æ¥æ‹¦æˆªå®é™…è¯·æ±‚ï¼Œ
Service Worker æ˜¯åœ¨æµè§ˆå™¨åå°è¿è¡Œçš„ JavaScript è„šæœ¬ï¼Œå®ƒå¯ä»¥æ‹¦æˆªå’Œå¤„ç†æµè§ˆå™¨å‘å‡ºçš„ç½‘ç»œè¯·æ±‚ï¼Œä»è€Œå®ç°ç¦»çº¿ç¼“å­˜ã€æ¶ˆæ¯æ¨é€ã€ç½‘ç»œä»£ç†ç­‰åŠŸèƒ½ã€‚

å…¶å®ä½ å¹¶ä¸éœ€è¦ç†è§£å…³äº [Service Worker API](https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API) çš„å†…å®¹ã€‚

ä¸Šæ–‡æåˆ° `MSW Browser`ï¼Œå®ƒæ˜¯è¿è¡Œåœ¨æµè§ˆå™¨ç«¯çš„ï¼Œè¿˜æœ‰ `MSW Node`ï¼Œå¯ä»¥ä¸ç°æœ‰çš„æµ‹è¯•æ¡†æ¶ï¼ˆå¦‚ Jestã€Mocha ç­‰ï¼‰é›†æˆã€‚

## å®ç°æ–¹å¼

æœ¬ç« èŠ‚é€šè¿‡ `vite` åˆ›å»ºä¸€ä¸ª `vue3` + `ts` é¡¹ç›®ï¼Œå»é›†æˆ `MSW` + `Faker`ï¼Œå…¶ä»–æ–¹æ¡ˆç†è®ºä¸Šç±»ä¼¼ï¼Œ**ä¸åŒç‚¹**æˆ‘ä¼šåœ¨æ–‡ä¸­æåˆ°ã€‚

æˆ‘å·²å°† demo ä»£ç ä¸Šä¼ è‡³ [github](https://github.com/codexu/msw-mock-demo)ã€‚

### åˆå§‹åŒ–é¡¹ç›®

```
npm create vite@latest
```

é€‰æ‹© vueï¼Œtypescriptï¼ˆéšæ„ï¼Œè¿™é‡Œä¸»è¦æ˜¯æ¼”ç¤º MSW å’Œ Faker å¯¹ ts çš„æ”¯æŒï¼‰ã€‚

```
cd my-mock-app
npm install
```

è¿™é‡Œä¸åšå¤šè®²ï¼Œå¤§å®¶è½»è½¦ç†Ÿè·¯ã€‚

### å®‰è£…ä¾èµ–

```
npm install msw @faker-js/faker --save-dev
npm install axios --save
```

å®‰è£… axios æ–¹ä¾¿å¯¹æ¯”æµ‹è¯• Ajax å’Œ Fetch çš„è¯·æ±‚ã€‚

### å®šä¹‰æ¥å£

åœ¨ `src/mocks` ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª `handlers.ts` æ–‡ä»¶ï¼Œå®ƒä»¥åå¯ä»¥åœ¨æµè§ˆå™¨æˆ– Node ç¯å¢ƒä¸­å¤ç”¨ã€‚

```
mkdir src/mocks
touch src/mocks/handlers.ts
```

ç„¶åé€‰æ‹©ä½¿ç”¨çš„è¯·æ±‚ç±»å‹ï¼ŒRest API æˆ– GraphQL APIã€‚

> GraphQL ç»å¤§å¤šæ•°å›¢é˜Ÿéƒ½æ²¡æœ‰ä½¿ç”¨ï¼Œè¿™é‡Œä»¥ Rest API ä¸ºä¸»è®²è¿°ã€‚

æˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ªç®€å•çš„ get è¯·æ±‚ï¼š

```ts
import { rest } from 'msw';

export const handlers = [
  rest.get('/api/user', (req, res, ctx) => {
    return res(
      ctx.status(200),
      ctx.delay(1000),
      ctx.json({ username: 'codexu' })
    );
  }),
];
```

ä¸Šè¿°ä»£ç å°†æ¨¡æ‹Ÿè¯·æ±‚ä¸€ä¸ª**çŠ¶æ€ç **ä¸º 200 çš„è¯·æ±‚ï¼Œè¿”å› **json** æ•°æ®ï¼Œå¹¶ä¸”**å»¶è¿Ÿ** 1000 msã€‚

### é›†æˆåˆ°é¡¹ç›®

é›†æˆä¹Ÿåˆ†ä¸ºä¸¤ç§ï¼Œå°±æ˜¯å‰æ–‡æåˆ°çš„ `Browser` å’Œ `Node` ç¯å¢ƒï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆæå®šæµè§ˆå™¨ã€‚

åœ¨ `src/mocks` ä¸­åˆ›å»ºä¸€ä¸ª `browser.js` æ–‡ä»¶ï¼Œåœ¨å…¶ä¸­é…ç½® Service Workerã€‚

```
import { setupWorker } from 'msw';
import { handlers } from './handlers';

export const worker = setupWorker(...handlers);
```

éšåéœ€è¦åœ¨Â `public`Â æ–‡ä»¶å¤¹ä¸­ç”Ÿæˆä¸€ä¸ª Service Worker è„šæœ¬ï¼Œç„¶è€Œæˆ‘ä»¬ä¸å¿…è‡ªå·±ç¼–å†™ä»»ä½• worker çš„ä»£ç ï¼Œç›´æ¥ä½¿ç”¨ MSW CLI æä¾›çš„åŠŸèƒ½å³å¯ã€‚

```
npx msw init <PUBLIC_DIR> --save
npx msw init public/ --save
```

âš ï¸ æ³¨æ„è¿™é‡Œçš„ `<PUBLIC_DIR>`ï¼Œä¸åŒçš„ç¯å¢ƒä¸‹è¿™ä¸ªæ˜¯æœ‰ä¸€äº›åŒºåˆ«çš„ã€‚

å¯ä»¥å‚è€ƒä»¥ä¸‹ä¸‹é¢çš„è¡¨æ ¼ï¼š

| é¡¹ç›® | PUBLIC_DIR |
| -- | -- |
| [Create React App](https://create-react-app.dev/) | `./public` |
| [GatsbyJS](https://www.gatsbyjs.org/)             | `./static` |
| [NextJS](https://nextjs.org/)                     | `./public` |
| [VueJS](https://vuejs.org/)                       | `./public` |
| [Angular](https://angular.io/)                    | `./src` |
| [Preact](https://preactjs.com/)                   | `./src/static` |
| [Ember.js](https://emberjs.com/)                  | `./public` |
| [Svelte.js](https://svelte.dev/)                  | `./public` |
| [SvelteKit](https://kit.svelte.dev/)              | `./static` |
| [Vite](https://vitejs.dev/)                       | `./public` |

> PUBLIC_DIR é€šå¸¸æ˜¯æµè§ˆå™¨è®¿é—®é¡µé¢æ—¶çš„æ ¹ç›®å½•ï¼Œå³ä½ æ‰“åŒ…æ—¶çš„ ./buildã€./public æˆ– ./dist ç­‰ã€‚

åœ¨ main.ts ä¸­åŠ å…¥ï¼š

```ts
if (import.meta.env.MODE === 'development') {
  const { worker } = await import("./mocks/browser");
  worker.start()
}
```

è¿™æ®µä»£ç æ˜¯åœ¨å¼€å‘ç¯å¢ƒä¸­åŠ¨æ€åŠ è½½ã€‚

è¿™æ—¶è¿è¡Œ npm run devï¼Œåœ¨é¡µé¢ä¸­è°ƒç”¨ä¸€ä¸‹ï¼š

```ts
import axios from 'axios';
axios.get('/api/user');
```

å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªè¯·æ±‚è€—æ—¶1ç§’åï¼Œè¯·æ±‚æˆåŠŸï¼Œå¹¶è¿”å›äº†é¢„è®¾çš„ usernameã€‚

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7713e45f4a854660af4add1f0e4b1b0a~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=815&h=273&s=24377&e=png&b=fefefe)

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4d85332f58f24aa5b9ba9f33a3a5db70~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=703&h=233&s=14825&e=png&b=fefefe)

å½“ç„¶ä½¿ç”¨ fetch ä¹Ÿæ˜¯å¯ä»¥çš„ï¼š

```ts
fetch('/api/user')
```

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/80f6307b87474d1a87ae0e036643d05f~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=864&h=82&s=8531&e=png&b=f0f4f7)

åˆ°è¿™æ­¥å·²ç»å®Œæˆäº†é¡¹ç›®é…ç½® mock çš„ç¯å¢ƒï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Ÿ

æ¥ä¸‹æ¥æˆ‘ä»¬è®© mock åŠŸèƒ½å˜å¾—æ›´åŠ å¼ºå¤§ã€‚

## ä¼ªé€ â€œçœŸå®â€æ•°æ®

ç”¨ç®€å•çš„å­—ç¬¦ä¸²æˆ–è€…éšæœºæ•°ç»„åˆ›å»ºçš„æµ‹è¯•æ•°æ®æ˜¯æ— æ³•æ»¡è¶³æµ‹è¯•çš„éœ€æ±‚çš„ï¼Œä½¿ç”¨ Faker å¯ä»¥ç”Ÿæˆçœ‹èµ·æ¥æ¯”è¾ƒâ€œçœŸå®â€çš„æµ‹è¯•æ•°æ®ã€‚

ä½¿ç”¨ ts å¼€å‘ï¼Œæœ‰éå¸¸æ–¹ä¾¿çš„ä»£ç æç¤ºï¼Œå‡ ä¹ä¸ç”¨ç¿»æ–‡æ¡£å°±å¯ä»¥æ‰¾åˆ°éœ€è¦ä¼ªé€ çš„æ•°æ®ã€‚ğŸ‘‡

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7253feb6d8944f89a68ad19d57e5a478~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=788&h=467&s=32601&e=png&b=262b32)

è¿™é‡Œå¯ä»¥æ³¨æ„ä¸€ä¸‹ï¼Œfaker æ˜¯æ”¯æŒå¤šå›½è¯­çš„ï¼Œåœ¨ import æ—¶å¯ä»¥é€‰æ‹©ä½ éœ€è¦çš„è¯­è¨€ï¼Œä¾‹å¦‚è¿™é‡Œä½¿ç”¨ä¸­æ–‡ï¼š

```ts
import { faker } from "@faker-js/faker/locale/zh_CN";
```

ç„¶åæ”¹é€ ä¸€ä¸‹ä¹‹å‰çš„æ¥å£ï¼Œè®©å…¶è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œé‡Œé¢ä¸°å¯Œä¸€äº›å­—æ®µï¼š

```ts
rest.get('/api/user', (req, res, ctx) => {
  return res(
    ctx.status(200), 
    ctx.delay(1000),
    ctx.json(
      Array.from({ length: 10 }).map(() => ({
        fullname: faker.person.fullName(),
        email: faker.internet.email(),
        avatar: faker.image.avatar(),
        address: faker.location.streetAddress(),
      }))
    )
  );
}),
```

ä¿å­˜ä¹‹åï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨åˆ·æ–°ï¼Œå†æ¬¡è¯·æ±‚äº†æ¥å£ï¼Œè¿™æ¬¡è¿”å›çš„æ•°æ®å¯ä»¥çœ‹åˆ°å·²ç»å˜åŒ–æˆğŸ‘‡ã€‚

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1df12636fed64f07a366d211e8995879~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=772&h=316&s=44343&e=png&b=fefdfd)

å¯ä»¥æ³¨æ„çš„æ˜¯ï¼Œå¤´åƒå­—æ®µè¿”å›çš„é“¾æ¥æ˜¯çœŸå®çš„å›¾ç‰‡å“¦ã€‚

## æ·±å…¥å­¦ä¹ 

> **çœæµï¼šå‰æ–‡å·²ç»å¯ä»¥æ»¡è¶³ 90% çš„å¼€å‘éœ€æ±‚ï¼Œæœ¬ç« èŠ‚å¯ä»¥æ–Ÿé…Œå‚è€ƒã€‚**

### Methods

rest æ”¯æŒæ‰€æœ‰çš„è¯·æ±‚æ–¹å¼ï¼š

- `rest.get()`
- `rest.post()`
- `rest.put()`
- `rest.patch()`
- `rest.delete()`
- `rest.options()`

å¹¶ä¸”è¿˜æä¾›äº†ä¸€ä¸ª `rest.all()` æ–¹æ³•ç”¨äºæ‹¦æˆªä»»ä½•è¯·æ±‚ã€‚

### Request

å‰æ–‡ä¾‹å­ä¸­ï¼Œè°ƒç”¨ rest æ–¹æ³•æ—¶ï¼Œå¯ä»¥çœ‹åˆ° Response resolver ä¸­å…·æœ‰ä¸‰ä¸ªå‚æ•°ï¼š

```ts
rest.get('/api/user', (req, res, ctx) => {});
```

å¦‚æœäº†è§£è¿‡ express çš„åŒå­¦åº”è¯¥å°±å¾ˆç†Ÿæ‚‰äº†ï¼Œè¯­æ³•æ˜¯ä¸€æ ·çš„ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬è·å–åˆ°ä¸€äº›è¯·æ±‚å‚æ•°ï¼Œè¿™æ ·æ¨¡æ‹Ÿçš„è¯·æ±‚å°±æ›´åŠ çœŸå®äº†ã€‚

å€¼å¾—ä¸€æçš„æ˜¯ `req.passthrough()`ï¼Œå®ƒå¯ä»¥ä½¿ä½ çš„è¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨ï¼ŒåŠ å…¥åˆ¤æ–­å³å¯å®ç°**æ¡ä»¶å“åº”**ï¼š

```ts
import { rest } from 'msw'

export const handlers = [
  rest.post('/api/user', (req, res, ctx) => 
    if (req.url.searchParams.has('id')) {
      return req.passthrough()
    }
    return res(ctx.text('codexu'))
  })
]
```

å½“ç„¶ï¼Œå®ƒè¿˜æä¾›äº†å¾ˆå¤šå…¶ä»–åŠŸèƒ½ï¼Œæœ‰å…´è¶£å¯ä»¥[å‚è€ƒæ–‡æ¡£](https://mswjs.io/docs/api/request)ã€‚

### Response

[Response](https://mswjs.io/docs/api/response) åˆ™æ˜¯å¯ä»¥å¤„ç†æ¥å£è¿”å›ï¼Œä¾‹å¦‚å»¶æ—¶ã€çŠ¶æ€ç å’Œæ•°æ®å¤„ç†ç­‰ã€‚

å¦å¤–å€¼å¾—ä¸€æçš„æ—¶ `res.once` ä»£è¡¨ç€åªèƒ½è¯·æ±‚ä¸€æ¬¡ã€‚

```ts
rest.get('/api/user', (req, res, ctx) => {
  return res.once(ctx.json({ username: 'codexu' }))
})
```

ç¬¬ä¸€æ¬¡è°ƒç”¨ `fetch('/api/user')`ï¼Œå¯ä»¥æ­£å¸¸è¿”å›è¯·æ±‚å†…å®¹ã€‚

ç¬¬äºŒæ¬¡è°ƒç”¨ `fetch('/api/user')`, åˆ™ä¼šæç¤º `ERR: Network error! (no such endpoint)`ã€‚

### Context

[Context](https://mswjs.io/docs/api/context) å¸¸ç”¨çš„å°±æ˜¯ï¼š

- `status`: ç”¨äºå¤„ç†çŠ¶æ€ç ã€‚
- `delay`: ç”¨äºå»¶æ—¶ï¼Œæ¨¡æ‹ŸçœŸå®çš„è¯·æ±‚é€Ÿåº¦ã€‚
- `json`: ç”¨äºè¿”å› json æ•°æ®ã€‚

é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æä¾›äº†ï¼š

- [set](https://mswjs.io/docs/api/context/set)ï¼šç”¨äºè®¾ç½® headersã€‚
- [body](https://mswjs.io/docs/api/context/body)ï¼šåœ¨ body è¿”å›ï¼Œä¸å‚ä¸ Content-Type è½¬æ¢ï¼Œä¾‹å¦‚äºŒè¿›åˆ¶æ•°æ®ã€‚
- [text](https://mswjs.io/docs/api/context/text)ï¼šContent-Type: text/plainï¼Œè¿”å›çº¯æ–‡æœ¬ã€‚
- [xml](https://mswjs.io/docs/api/context/xml)ï¼šContent-Type: text/xmlï¼Œè¿”å› XML æ•°æ®ã€‚
- [data](https://mswjs.io/docs/api/context/data)ï¼šé’ˆå¯¹ GraphQL æ“ä½œçš„å“åº”ã€‚
- [errors](https://mswjs.io/docs/api/context/errors)ï¼šé’ˆå¯¹ GraphQL çš„é”™è¯¯è¿”å›ã€‚
- [fetch](https://mswjs.io/docs/api/context/fetch)ï¼šå¯ä»¥ç†è§£ä¸ºåœ¨æ‹¦æˆªè¯·æ±‚æ—¶ï¼Œå‘é€ä¸€ä¸ªçœŸå®çš„è¯·æ±‚ï¼Œç”¨äºä¿®æ­£è¿”å›ç»“æœæ—¶ä½¿ç”¨ã€‚

### ç”¨äºæµ‹è¯•

MSW å¯ä»¥ç›´æ¥å¤ç”¨ handlersï¼Œç”¨äºæµ‹è¯•ã€‚

åœ¨ `src/mocks/` ç›®å½•ä¸‹åˆ›å»º `server.js`ï¼š

```ts
import { setupServer } from 'msw/node';
import { handlers } from './handlers';

export const server = setupServer(...handlers);
```

ç”±äºå„ç§æµ‹è¯•æ¡†æ¶ç”¨æ³•ä¸åŒï¼Œè¿™é‡Œå°±ä¸å†è¿‡å¤šæè¿°ï¼Œæˆ‘æƒ³å¤§å®¶ä¹Ÿå¾ˆå°‘ä¼šä½¿ç”¨åˆ°æµ‹è¯•çš„åŠŸèƒ½ã€‚

## æ€»ç»“

æ–‡ç« å‰åŠæ®µè®²è¿°äº†ç°åœ¨ä¸»æµçš„ mock æ–¹æ¡ˆï¼Œè¿›è¡Œäº†ä¼˜ç¼ºç‚¹çš„å¯¹æ¯”ï¼Œå¹¶é€‰å‡ºäº†ä¸¤ç§æœ€ä¸ºå®ç”¨çš„æ–¹æ¡ˆã€‚æˆ‘é€‰æ‹©äº†è¯·æ±‚æ‹¦æˆªçš„æ–¹å¼ï¼Œä½†æ²¡é€‰æ‹© mock.js ä½œä¸ºæœ€ç»ˆæ–¹æ¡ˆï¼Œè€Œæ˜¯é€‰æ‹©äº† MSW + Fakerï¼Œå› ä¸ºè¿™ä¸ªç»„åˆæ–¹æ¡ˆæ›´åŠ å¼ºå¤§ã€‚

**æŠ€æœ¯é€‰å‹ä¸åˆ†å¥½åï¼Œåº”æ ¹æ®ä¸åŒçš„åœºæ™¯é€‰æ‹©æ›´åˆé€‚æ–¹æ¡ˆã€‚**

æ¨èå¤§å®¶å°è¯•ä¸€ä¸‹æˆ‘çš„æ–¹æ¡ˆï¼Œä¹Ÿè®¸å®ƒæ›´é€‚åˆä½ å‘¢ï¼Ÿ

## å‚è€ƒ

- [Github Demo æºç ](https://github.com/codexu/msw-mock-demo)
- [Mock Service Worker å®˜ç½‘](https://mswjs.io/)
- [Service Worker API æ–‡æ¡£](https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API)
- [Faker.js å®˜ç½‘](https://fakerjs.dev/)
- [Mock.js æ–‡æ¡£](https://github.com/nuysoft/Mock/wiki/Getting-Started)